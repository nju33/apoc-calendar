<ul class="apocCalendar-Component_DateTable">
	{{#each $days as day}}
		<li class="{{getDayCellClass(day)}}" on:click="selectDay(day)">
			<DayCell :day />
		</li>
	{{/each}}

	{{#each $dates as date}}
		<li class="{{getDateCellClass(date)}}">
			<DateCell :date />
		</li>
	{{/each}}
</ul>
			<!-- class="{{getDateCellClass(date, minDate, maxDate, pad)}}"
			on:click="selectDate(date)"
			on:mousedown="handleMousedown(date)"
			on:mousemove="handleMousemove(date)"
			on:mouseup="handleMouseup(date)"> -->

<script>
import throttle from 'lodash.throttle';
import DayCell from './day-cell.html';
import DateCell from './date-cell.html';
import {range} from './helpers';
import DatePad from './date-pad';

export default {
	components: {DayCell, DateCell},
	data() {
		return {
		// 	dates: [],
    //
		// 	mousedown: false,
		// 	from: null,
			to: null,
		};
	},
	helpers: {
		// getDayCellClass(store, {day}) {
		getDayCellClass() {
			const classnames = ['apocCalendar-Component_DayCell'];
			// if (store.isActiveDay(day)) {
			// 	classnames.push('apocCalendar-Is_Selected');
			// }
			return classnames.join(' ');
		},
		getDateCellClass(date, minDate, maxDate, pad) {
			const classnames = ['apocCalendar-Component_DateCell'];

			if (date instanceof DatePad) {
				classnames.shift();
			}

			// if (!pad && (date.next || date.prev)) {
			// 	classnames.push('apocCalendar-Is_Hidden');
			// }
      //
			// if (date.selected) {
			// 	classnames.push('apocCalendar-Is_Selected');
			// }
      //
			// if (date.next) {
			// 	classnames.push('apocCalendar-Is_Next');
			// } else if (date.prev) {
			// 	classnames.push('apocCalendar-Is_Prev');
			// }
      //
			// if (date.disabled || (date.year === maxDate.year && date.month === maxDate.month)) {
			// 	classnames.push('apocCalendar-Is_Disabled');
			// }

			return classnames.join(' ');
		}
	},
	// methods: {
	// 	selectDay(day) {
	// 		this.get('store').selectDay(day);
	// 	},
	// 	selectDate(date) {
	// 		this.get('store').selectDate(date);
	// 	},
	// 	handleMousedown(date) {
	// 		this.set({
	// 			mousedown: true,
	// 			from: date,
	// 			to: null,
	// 		});
	// 		this.get('store').selectRangeDate(date);
	// 	},
	// 	handleMousemove: throttle(function (date) {
	// 		if (this.get('mousedown')) {
	// 			const {store, from} = this.get();
	// 			if (from === date) {
	// 				return;
	// 			}
  //
	// 			this.set({to: date});
	// 			store.selectRangeDate(from, date);
	// 		}
	// 	}, 100),
	// 	handleMouseup(date) {
	// 		if (!this.get('mousedown')) {
	// 			return;
	// 		}
  //
	// 		this.set({
	// 			mousedown: false,
	// 			from: null,
	// 			to: null,
	// 		});
	// 		this.get('store').endSelectRangeDate();
	// 	}
	// },
	oncreate() {
		console.log(this)
	}
	// oncreate() {
	// 	console.log(this)
	// 	const {store, minDate, maxDate, initial, pad} = this.get();
	// 	const initialDate = new Date(initial);
  //   const year = initialDate.getFullYear();
  //   const month = initialDate.getMonth();
	// 	store.pad = pad;
	// 	store.setOptions({minDate, maxDate});
	// 	store.setDates(year, month, this.options.data.pagerStep, true);
  //
	// 	this.set({
	// 		dates: this.options.data.store.currentDates,
	// 	})
  //
	// 	store.observe('currentDates', currentDates => {
	// 		this.set({
	// 			dates: currentDates
	// 		})
	// 	});
	// 	store.observe('data', () => {
	// 		// console.log(this.get('initial'), store.get('currentDates'))
	// 		this.set({
	// 			dates: store.get('currentDates')
	// 		})
	// 	});
  //
	// }
}
</script>

<style>
.apocCalendar-Component_DateTable {
	display: grid;
	grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
	grid-auto-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
	grid-gap: 1px;
	list-style: none;
	padding: 0;
	margin: 0;
	user-select: none;
	position: relative;
	z-index: 2;
}

.apocCalendar-Component_DayCell,
.apocCalendar-Component_DateCell {
	transition: .1s;
	font-size: .8em;
	width: 3em;
	cursor: pointer;
	background: #fff;
	margin: 0;

	&.apocCalendar-Is_Selected:not(.apocCalendar-Is_Disabled):not(.apocCalendar-Is_Hidden) {
		background: #cb1b45;
	}

	&:not(.apocCalendar-Is_Prev):not(.apocCalendar-Is_Next):not(.apocCalendar-Is_Disabled):not(.apocCalendar-Is_Selected):hover {
		background: #ccc;
	}
}

/* .apocCalendar-Is_Prev, */
/* .apocCalendar-Is_Next, */
.apocCalendar-Is_Disabled {
	opacity: .3;
}
</style>
