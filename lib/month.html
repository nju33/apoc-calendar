<ul class="apocCalendar-Component_DateTable">
	{{#each $days as day, i}}
		<li class="{{getDayCellClass($getDayState(i), $__key_dates__)}}" on:click="selectDay(i)">
			<DayCell :day />
		</li>
	{{/each}}

	{{#each $dates as date}}
		<li
			class="{{getDateCellClass(date, $__key_dates__)}}"
			on:click="selectDate(date)"
		>
			<DateCell :date />
		</li>
	{{/each}}
</ul>

<script>
import throttle from 'lodash.throttle';
import DayCell from './day-cell.html';
import DateCell from './date-cell.html';
import {range} from './helpers';
import DatePad from './date-pad';

export default {
	components: {DayCell, DateCell},
	helpers: {
		getDayCellClass(active) {
			const classnames = ['apocCalendar-Component_DayCell'];

			if (active) {
				classnames.push('apocCalendar-Is_Selected');
			}

			return classnames.join(' ');
		},
		getDateCellClass(date, selection) {
			const classnames = ['apocCalendar-Component_DateCell'];

			if (date instanceof DatePad) {
				classnames.push('apocCalendar-Is_Pad');
			}

			if (date.isSelected()) {
				classnames.push('apocCalendar-Is_Selected');
			}

			return classnames.join(' ');
		}
	},
	methods: {
		selectDay(day) {
			this.store.selectDay(day);
		},
		selectDate(date) {
			if (date.isSelected()) {
				date.deselect();
			} else {
				date.select();
			}
			this.store.updateDates();
		},
	},
}
</script>

<style>
.apocCalendar-Component_DateTable {
	display: grid;
	grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
	grid-auto-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
	grid-gap: 1px;
	list-style: none;
	padding: 0;
	margin: 0;
	user-select: none;
	position: relative;
	z-index: 2;
}

.apocCalendar-Component_DayCell,
.apocCalendar-Component_DateCell {
	/* transition: .1s; */
	font-size: .8em;
	width: 3em;
	height: 1.5em;
	cursor: pointer;
	background: #fff;
	margin: 0;

	&.apocCalendar-Is_Selected:not(.apocCalendar-Is_Disabled):not(.apocCalendar-Is_Hidden) {
		background: #cb1b45;
	}

	&:not(.apocCalendar-Is_Prev):not(.apocCalendar-Is_Next):not(.apocCalendar-Is_Disabled):not(.apocCalendar-Is_Selected):not(.apocCalendar-Is_Pad):hover {
		background: #ccc;
	}
}

.apocCalendar-Is_Pad {
	background: transparent;
}
</style>
