<ul class="apocCalendar-Component_DateTable">
	{{#each dates as date @day}}
		<li class="apocCalendar-Component_DateCell" on:click="selectDay(date.day)">
			<DayCell :date :convertDay />
		</li>
	{{/each}}
	{{#each dates as date}}
		<li class="{{getDateCellClass(date.selected)}}" on:click="selectDate(date)">
			<DateCell :date />
		</li>
	{{/each}}
</ul>

<script>
import DayCell from './day-cell.html';
import DateCell from './date-cell.html';
import {range} from './helpers';

export default {
	components: {DayCell, DateCell},
	data() {
		return {
			dates: [],
		};
	},
	helpers: {
		getDateCellClass(selected) {
			const classnames = ['apocCalendar-Component_DateCell'];
			if (selected) {
				classnames.push('apocCalendar-Is_Selected');
			}
			return classnames.join(' ');
		}
	},
	methods: {
		selectDay(day) {
			this.options.data.store.selectDay(day);
		},
		selectDate(date) {
			this.options.data.store.selectDate(date);
		}
	},
	oncreate() {
		const todayDate = new Date();
    const year = todayDate.getFullYear();
    const month = todayDate.getMonth();
		this.options.data.store.setDates(year, month);

		this.set({
			dates: this.options.data.store.getCurrentDates()
		})

		this.options.data.store.observe('data', () => {
			this.set({
				dates: this.options.data.store.getCurrentDates()
			})
		});


		// this.options.data.store.observe('selected', dates => {
		// 	this.set({
		// 		selected: this.options.data.store.getSelected()
		// 	})
		// });
	}
}
</script>

<style>
.apocCalendar-Component_DateTable {
	display: grid;
	grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
	grid-auto-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
	list-style: none;
	padding: 0;
	margin: 0;
	user-select: none;
}

.apocCalendar-Component_DateCell {
	transition: .1s;
	padding: 1em .5em;
	cursor: pointer;

	&.apocCalendar-Is_Selected {
		background: #cb1b45;
	}

	&:hover {
		background: #ccc;
	}
}
</style>
